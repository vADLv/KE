# KE
Hierarchical product classification

## Категоризация названий товаров

### Данные для решения задачи

```
data
├── categories.csv
└── products.csv
```

**categories.csv** - файл с категориями на маркетплейсе. У каждой категории есть id, заголовок и путь в дереве
категорий.

Допустим у категории 2642 заголовок "Мелкие инструменты", а путь в дереве категорий - `1.10016.10072.10690.2642`. Если
заменить id категорий в этом пути на заголовки, то получим следующее дерево:

* Строительство и ремонт
    * Ручной инструмент и оснастка
        * Столярно-слесарные инструменты
            * Мелкие инструменты

**products.csv** - файл с товарами на маркетплейсе. У каждого товара есть id, заголовок и id категории, которой он
принадлежит. Товар всегда принадлежит листовой категории в дереве.

### Моделирование и оценка

Категоризация названий товаров это процесс определения категории на основе текстовых данных товара. Фактически, нужно
решить задачу классификации с множеством классов на основе текстового ввода. Для тестового задания мы упростили задачу и
ограничились 3 большими категориям и взяли лишь часть товаров.

Для того, чтобы решить задачу предсказания `category_id` по `product_title` можно использовать любую модель и любой
препроцессинг, если он подходит для этой задачи. Если вы будете использовать несколько моделей, то будет замечательно,
если вы приведете аргументацию своего выбора.

Мы рассчитываем, что в этом тестовом вы:

* Будете использовать кросс-валидацию
* Выберете правильную метрику исходя из задачи и данных
* Посчитаете метрику на разных уровнях дерева категорий
* Изучите и приведете в отчете примеры неверно категоризированных товаров
* Опишите проведенную работу и достигнутые метрики в отчете

### Ожидаемые результаты

На выходе мы ожидаем получить архив со следующим содержимым

* `model.joblib` - Модель, которая умеет предсказывать title -> category_id
* `demo.py` + `demo_requirements.txt` - Скрипт и его зависимости с примером работы модели. В скрипте модель должна быть
  загружена в память и должна сделать несколько предсказаний. Live Demo с использованием `input()` приветствуется. Будет
  здорово, если скрипт будет просить название товара, и выводить полное название категории.
* `report.ipynb` - Отчет о проделанной работе, где видно какую работу вы проделали и чего добились
